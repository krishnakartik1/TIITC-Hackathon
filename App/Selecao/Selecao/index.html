<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Posture Correction</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  <script src="assets/js/planner2.js"></script>

  <!-- =======================================================
  * Template Name: Selecao - v4.1.0
  * Template URL: https://bootstrapmade.com/selecao-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center  header-transparent ">
    <div class="container d-flex align-items-center justify-content-between">

      <div class="logo">
        <h1><a href="index.html">POSTURE CORRECTION</a></h1>
        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <a href="index.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
      </div>

      <nav id="navbar" class="navbar">
  
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->

  <!-- ======= Hero Section ======= -->
  <section id="hero" class="d-flex flex-column justify-content-end align-items-center">
    <div id="heroCarousel" data-bs-interval="5000" class="container carousel carousel-fade" data-bs-ride="carousel">

      <!-- Slide 1 -->
      <div class="carousel-item active">
        <div class="carousel-container">
          <h2 class="animate__animated animate__fadeInDown">What it's About</h2>
          <p class="animate__animated fanimate__adeInUp">Due to coronavirus outbreak majorities of companies have assigned its employees with work from home. It definitely offers comfort being in your PJs but with lack of proper office furniture it can be tricky to maintain the right posture while working from home.</p>
          <!-- <a href="#about" class="btn-get-started animate__animated animate__fadeInUp scrollto">Read More</a> -->
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="carousel-item">
        <div class="carousel-container">
          <h2 class="animate__animated animate__fadeInDown">Physical Benifits</h2>
          <p class="animate__animated animate__fadeInUp">It protects you from various musculoskeletal disorders.</br>
            It saves you from developing a ‘tech-neck’ i.e., head down, back-bent slouching position and shoulders forward leaning</br>
            It improves blood circulation in the body</br>
            It decreases back and body pains</br>
            It makes your muscles stronger, especially of the back</br>
            It allows you to burn more calories</p>
          <!-- <a href="#about" class="btn-get-started animate__animated animate__fadeInUp scrollto">Read More</a> -->
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="carousel-item">
        <div class="carousel-container">
          <h2 class="animate__animated animate__fadeInDown">Mental Benifits</h2>
          <p class="animate__animated animate__fadeInUp">It leads to better productivity
            It enhances the mental alertness
            It reduces mental fatigue
            It improves breathing
            It boosts energy level</p>
          <!-- <a href="#about" class="btn-get-started animate__animated animate__fadeInUp scrollto">Read More</a> -->
        </div>
      </div>

      <a class="carousel-control-prev" href="#heroCarousel" role="button" data-bs-slide="prev">
        <span class="carousel-control-prev-icon bx bx-chevron-left" aria-hidden="true"></span>
      </a>

      <a class="carousel-control-next" href="#heroCarousel" role="button" data-bs-slide="next">
        <span class="carousel-control-next-icon bx bx-chevron-right" aria-hidden="true"></span>
      </a>

    </div>

    <svg class="hero-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28 " preserveAspectRatio="none">
      <defs>
        <path id="wave-path" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z">
      </defs>
      <g class="wave1">
        <use xlink:href="#wave-path" x="50" y="3" fill="rgba(255,255,255, .1)">
      </g>
      <g class="wave2">
        <use xlink:href="#wave-path" x="50" y="0" fill="rgba(255,255,255, .2)">
      </g>
      <g class="wave3">
        <use xlink:href="#wave-path" x="50" y="9" fill="#fff">
      </g>
    </svg>

  </section><!-- End Hero -->

  <main id="main">

    <!-- ======= About Section ======= -->
    <section id="about" class="about">
      <div class="container">

        <div class="section-title" data-aos="zoom-out">
          <h2>About</h2>
          <p>Who we are</p>
        </div>

        <div class="row content" data-aos="fade-up">
          <div class="col-lg-6">
            <p>
              Work From Home Posture Correction Hackathon Team
            </p>
            
          </div>
          <div class="col-lg-6 pt-4 pt-lg-0">
            <p>
              Project Description
            </p>
            <a href="" class="btn-learn-more">Learn More</a>
          </div>
        </div>

      </div>
    </section><!-- End About Section -->

    <!-- ======= Features Section ======= -->
    <section id="features" class="features">
      <div class="container">

        <ul class="nav nav-tabs row d-flex">
          <li class="nav-item col-3" data-aos="zoom-in">
            <a class="nav-link active show" data-bs-toggle="tab" href="#tab-1">
              <i class="ri-gps-line"></i>
              <h4 class="d-none d-lg-block">Real Time Posture Monitoring</h4>
            </a>
          </li>
          <li class="nav-item col-3" data-aos="zoom-in" data-aos-delay="100">
            <a class="nav-link" data-bs-toggle="tab" href="#tab-2">
              <i class="ri-body-scan-line"></i>
              <h4 class="d-none d-lg-block">Setup your Workplace</h4>
            </a>
          </li>
          <li class="nav-item col-3" data-aos="zoom-in" data-aos-delay="200">
            <a class="nav-link" data-bs-toggle="tab" href="#tab-3">
              <i class="ri-sun-line"></i>
              <h4 class="d-none d-lg-block">Contact for Assistance</h4>
            </a>
          </li>
          <li class="nav-item col-3" data-aos="zoom-in" data-aos-delay="300">
            <a class="nav-link" data-bs-toggle="tab" href="#tab-4">
              <i class="ri-store-line"></i>
              <h4 class="d-none d-lg-block">Get Exercie Break Alert</h4>
            </a>
          </li>
        </ul>

        <div class="tab-content" data-aos="fade-up">
          <div class="tab-pane active show" id="tab-1">
            <div class="row">
              <div class="col-lg-6 order-2 order-lg-1 mt-3 mt-lg-0">
                <h3>Real Time Posture Monitoring Using Web Cam.</h3>
                <p class="fst-italic">
                  Using Machine learning to help to maintain correct posture
                </p>
               
              </div>
              <div class="col-lg-6 order-1 order-lg-2 text-center">
                <img src="assets/img/features-1.png" alt="" class="img-fluid">
              </div>
            </div>
          </div>
          
          
          <div class="tab-pane" id="tab-2">
            <div class="row">
              <div class="col-lg-6 order-2 order-lg-1 mt-3 mt-lg-0">
                <h3>Setup Your Workplace using the AR Technology</h3>
                <p>
                  Take Measurement and get the recommendation from the AI
                </p>
                
              </div>
              <div class="col-lg-6 order-1 order-lg-2 text-center">
                <img src="assets/img/features-2.png" alt="" class="img-fluid">
              </div>
            </div>
          </div>
          
          <div class="tab-pane" id="tab-3">
            <div class="row">
              <div class="col-lg-6 order-2 order-lg-1 mt-3 mt-lg-0">
                <h3>Connect With our Experts</h3>
                <p>
                 Contact the experts and they can assist you with your posture
                </p>
               
              </div>
              <div class="col-lg-6 order-1 order-lg-2 text-center">
                <img src="assets/img/features-5.png " alt="" class="img-fluid">
              </div>
            </div>
          </div>
          <div class="tab-pane" id="tab-4">
            <div class="row">
              <div class="col-lg-6 order-2 order-lg-1 mt-3 mt-lg-0">
                <h3>Get Timely Exercise and Break Alert</h3>
                <p>
                 To keep you healthy, every 20 minutes break notification would be pushed.
                </p>
               
              </div>
              <div class="col-lg-6 order-1 order-lg-2 text-center">
                <img src="assets/img/features-6.png" alt="" class="img-fluid">
              </div>
            </div>
          </div>
        </div>

      </div>
    </section><!-- End Features Section -->

    <!-- ======= Cta Section ======= -->
    <section id="cta" class="cta">
      <div class="container">

        
        <div class="row" data-aos="zoom-out">
            <div class="col-lg-9 text-center text-lg-start">
              <h3>Lets Monitor</h3>
              <canvas id="canvas"></canvas>
            </div>
            <div class="col-lg-3 cta-btn-container text-center">
              <!-- <class="cta-btn align-middle" onclick="init()">Start Recording</a> -->
              <button class="cta-btn align-middle" id="startBtn" type="button" onclick="init()">Start</button>
              <div style="width: 300px; height: 300px;">
                <canvas id="myChart"></canvas>
              </div>
              
            </div>
            <div>
             
            </div>
           
        </div>
        
          <p id="label-container"></p>
         
         
        

        <div class="col-lg-12 cta-btn-container text-center">
          <p id="label-container"></p>
          <div class="section-title" data-aos="zoom-out">
            <p id="labelGoodPose"></p>
          <p id="labelBadPose"></p>
           
          </div>
          

        </div>



      </div>
    </section><!-- End Cta Section -->

     <!-- ======= Bad poses Section ======= -->
     <section id="badPoses" style="display:none;" class="services">
      <div class="container">

        <div class="section-title" data-aos="zoom-out">
          <h2>Poses</h2>
          <p>Bad Poses</p>
        </div>
       
        <div class="row">
          <div class="col-lg-12 col-md-12">
            <div class="icon-box" data-aos="zoom-in-left">
              
              <h4 class="title"><a href="">Bad Poses Screen Capture</a></h4>
              <p class="description">
                <div style="float:left"><canvas id="badPose1"></canvas></div>
            <div style="float:left"><canvas id="badPose2"></canvas></div>
            <div style="float:left"><canvas id="badPose3"></canvas></div>
            <div style="float:left"><canvas id="badPose4"></canvas></div>
            <div style="float:left"><canvas id="badPose5"></canvas></div>

              </p>
            </div>
          </div>

        </div>

      </div>
    </section><!-- End Monitoring Section -->

        <!-- ======= Monitoring Section ======= -->
        <section id="servicess" class="services">
          <div class="container">
    
            <div class="section-title" data-aos="zoom-out">
              <h2>Monitoring</h2>
              <p>Time based Bad Poses Analysis</p>
            </div>
           
            <div class="row">
              <div class="col-lg-12 col-md-12">
                <div class="icon-box" data-aos="zoom-in-left">
                  
                  <h4 class="title"><a href="">Chart</a></h4>
                  <p class="description">
                    <canvas id="badPostureChart"></canvas>

                  </p>
                </div>
              </div>

            </div>
    
          </div>
        </section><!-- End Monitoring Section -->

    <!-- ======= Services Section ======= -->
    <section id="exerciseSection" class="services">
      <div class="container">

        <div class="section-title" data-aos="zoom-out">
          <h2>Exercises</h2>
          <p>Do Streches</p>
        </div>
        <!-- <div id="messages">
          <p id="notify">Its Time to Take Break for 20 seconds</p>
          <div id="exercise"><p>Show Extercise</p> <button onclick="closeExercise()" >Close </button> </div>
      </div> -->
        <div class="row">
          <div class="col-lg-4 col-md-6">
            <iframe src="https://www.youtube.com/embed/g_tea8ZNk5A">
            </iframe>
          </div>
          <div class="col-lg-4 col-md-6 mt-5 mt-md-0">
            <iframe src="https://www.youtube.com/embed/4pKly2JojMw">
            </iframe>
          </div>

          <div class="col-lg-4 col-md-6 mt-5 mt-lg-0 ">
            <iframe src="https://www.youtube.com/embed/vuGnzLxRvZM">
            </iframe>
          </div>
          <div class="col-lg-4 col-md-6 mt-5">
            <iframe src="https://www.youtube.com/embed/x_WJ5cotyfE">
            </iframe>
          </div>

          <div class="col-lg-4 col-md-6 mt-5">
            <iframe src="https://www.youtube.com/embed/72MQmD8Z9Zw">
              
            </iframe>
          </div>
          <div class="col-lg-4 col-md-6 mt-5">
            <iframe src="https://www.youtube.com/embed/X3-gKPNyrTA">
              
            </iframe>
          </div>
        </div>

      </div>
    </section><!-- End Services Section -->





    <!-- ======= Pricing Section ======= -->
    <section id="20Break" class="pricing">
      <div class="container">

        <div class="section-title" data-aos="zoom-out">
          <h2>Break Time</h2>
          <p>20 - 20 - 20</p>
        </div>

        <div class="row">

          
          <div class="col-lg-4 col-md-6 mt-4 mt-md-0">
            <div class="box featured" data-aos="zoom-in" data-aos-delay="100">
              <h3>Stand Up</h3>
              <ul>
                <li>In every 20 minutes while working, as a reminder to take a break.</li>
              </ul>
            </div>
          </div>

          <div class="col-lg-4 col-md-6 mt-4 mt-md-0">
            <div class="box featured" data-aos="zoom-in" data-aos-delay="100">
              <h3>Break</h3>
              <ul>
                <li>A person can benefit from closing their eyes for 20 seconds every 20 minutes.</li>
              </ul>
            </div>
          </div>

          <div class="col-lg-4 col-md-6 mt-4 mt-md-0">
            <div class="box featured" data-aos="zoom-in" data-aos-delay="100">
              <h3>Look Out</h3>
              <ul>
                <li>Judging a distance of 20 feet inside can be difficult, but focusing on a tree or lamppost across the street should work well.</li>
              </ul>
            </div>
          </div>

        </div>

        
      

            <div class="row" id="bpane" style="display:none; margin-top: 30px;">
              <!-- <div class="col-lg-2 col-md-6 mt-4 mt-md-0 t text-center" >
                <div>&nbsp;</div>
                  </div> -->
              <div class="col-lg-12  text-center" >
                <div  data-aos="zoom-in" data-aos-delay="100">
                  <h3>Time Remaining  <span id="BSecond"></span></h3>
                  <div  class="progress" style=" height: 1px;">
                    <div class="progress-bar" id="pbar" role="progressbar" style="width: 100%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="20"></div>
                  </div>
                  </div>
                 
                </div>
                </div>

              

      </div>
    </section><!-- End Pricing Section -->
    <!-- ======= Workplace Section ======= -->
    <section id="cta" class="cta">
      <div class="container">

        
        <div class="row" data-aos="zoom-out">
            <div class="col-lg-9 text-center text-lg-start" id="ARWorkplace">
              <h3>Workplace Assessment</h3>
              <p>Please select your height</p>
              <div class="dropdown">
                <!-- <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Dropdown button
                </button>
                <div class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                  <a class="dropdown-item" href="#">Action</a>
                  <a class="dropdown-item" href="#">Another action</a>
                  <a class="dropdown-item" href="#">Something else here</a>
                </div> -->
                <select id="height" onchange="displayMeasurements(this)">
                  <option value="5" >5 Feet</option>
                  <option value="51">5 Feet 1 Inch</option>
                  <option value="52">5 Feet 2 Inches</option>
                  <option value="53">5 Feet 3 Inches</option>
                  <option value="54">5 Feet 4 Inches</option>
                  <option value="55">5 Feet 5 Inches</option>
                  <option value="56">5 Feet 6 Inches</option>
                  <option value="57">5 Feet 7 Inches</option>
                  <option value="58">5 Feet 8 Inches</option>
                  <option value="59">5 Feet 9 Inches</option>
                  <option value="510">5 Feet 10 Inches</option>
                  <option value="511">5 Feet 11 Inches</option>
                  <option value="6">6 Feet</option>
                  <option value="61">6 Feet 1 Inch</option>
                  <option value="62">6 Feet 2 Inches</option>
                  <option value="63">6 Feet 3 Inches</option>
                  <option value="64">6 Feet 4 Inches</option>
                </select>
              </div>
              <br>
              <div class="col-lg-4">
                <table class="table table-sm text-white">
                  <thead>
                    <tr>
                      <th scope="colgroup" colspan="3" >Ideal measurements for this height</th>
                      
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th rowspan="3" scope="rowgroup">Sitting</th>
                      <th scope="row">Monitor Height</th>
                      <td id="siteye">0</td>
                    </tr>
                    <tr>
                      <!-- <th scope="row">2</th> -->
                      <th scope="row">Seat Height</th>
                      <td id="seat">0</td>
                    </tr>
                    <tr>
                      <!-- <th scope="row">2</th> -->
                      <th scope="row">Keyboard Height</th>
                      <td id="sitelbow">0</td>
                    </tr>
                    <tr>
                      <th rowspan="2" scope="rowgroup">Standing</th>
                      <th scope="row">Monitor Height</th>
                      <td id="standeye">0</td>
                    </tr>
                    <tr>
                      <!-- <th scope="row">2</th> -->
                      <th scope="row">Keyboard Height</th>
                      <td id="standelbow">0</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <br>
              <p>Please click on the below button to measure distance using realtime AR</p>
            </div>
            <div class="col-lg-3 cta-btn-container text-center">
              <!-- <class="cta-btn align-middle" onclick="init()">Start Recording</a> -->
              <img src="assets/img/workstation-tool-sitstand.png" alt="Ergonomic Workstation" id="main-image" />
              <!-- <button class="cta-btn align-middle" id="startBtn" type="button" onclick="init()">Start</button> -->
              
            </div>
            <div>
             
            </div>
           
        </div>


      </div>
      <script type="module">
        import * as THREE from "./assets/js/three.module.js";
        import { ARButton } from "./assets/js/ARButton.js";
  
        var camera;
        var scene;
        var renderer;
        var arbutton;
        var controller;
        var reticle;
  
        var hitTestSource = null;
        var hitTestSourceRequested = false;
        console.log('checkxr');
        xrinit();
        console.log('checkxr');
        renderer.setAnimationLoop(render);
  
        function copy(x) {
          return JSON.parse(JSON.stringify(x));
        }
        
        function convertToInches(distance){
          return Math.round(((distance * 39.3701) + Number.EPSILON) * 100) / 100;
        }
  
        function xrinit() {
          renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
          renderer.setPixelRatio(window.devicePixelRatio);
          renderer.setSize(window.innerWidth, window.innerHeight);
          renderer.xr.enabled = true;
          // alert('hello');
          arbutton = ARButton.createButton(renderer, {
            requiredFeatures: ["hit-test"]
            // optionalFeatures: ['dom-overlay'],
            // domOverlay: { root: document.getElementById('arOverlay') }
          });
          document.getElementById("ARWorkplace").appendChild(arbutton);
          document.getElementById("ARWorkplace").appendChild(document.createElement('br'));
          document.getElementById("ARWorkplace").appendChild(document.createElement('br'));
          const label = document.createElement( 'label' );
          label.id = 'distanceMeasure';
          label.classList.add('label');
          label.classList.add('label-default');
          label.classList.add('text-secondary');
          label.innerHTML = "Distance from AR will be displayed here";
          // alert(distance);
          label.placeholder = "Distance from AR"
          document.getElementById("ARWorkplace").appendChild(label);
          
          // arbutton2 = ARButton.createButton(renderer, {
          //   requiredFeatures: ["hit-test"]
          //   // optionalFeatures: ['dom-overlay'],
          //   // domOverlay: { root: document.getElementById('arOverlay') }
          // });
          // document.body.appendChild(arbutton2);
  
          scene = new THREE.Scene();
          camera = new THREE.PerspectiveCamera(
            70,
            window.innerWidth / window.innerHeight,
            0.01,
            20
          );
  
          const geometry = new THREE.SphereGeometry(0.05, 32, 32);
  
          let count = 0;
          let first = "";
          let second = "";
  
          function onSelect() {
            let flag = false;
  
            if (reticle.visible) {
              const material = new THREE.MeshPhongMaterial({ color: 0xffffff });
              const mesh = new THREE.Mesh(geometry, material);
              mesh.position.setFromMatrixPosition(reticle.matrix);
              // mesh.scale.y = Math.random() * 2 + 1;
  
              if (count == 1) {
                second = copy(mesh.position);
                // alert("second" + second.x + "," + second.y + "," +second.z )
                // document.write((first.x - second.x))
                let dx = first.x - second.x;
                let dy = first.y - second.y;
                let dz = first.z - second.z;
                let distance = Math.sqrt(dx * dx + dy * dy + dz * dz);
                label.classList.remove("text-secondary");
                label.classList.add('text-white');
                distance = convertToInches(distance);
                label.innerHTML = distance + "\'\'";
                flag = true;
                // document.getElementById("distance").innerHTML = distance + "here";
              } else {
                first = copy(mesh.position);
                count = 1;
                // alert(first.x)
                // document.write(typeof first.x)
              }
              scene.add(mesh);
              if (flag == true) {
                endXRSession();
              }
            }
          }
  
          controller = renderer.xr.getController(0);
          controller.addEventListener("select", onSelect);
          scene.add(controller);
  
          var light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 1);
          light.position.set(0.5, 1, 0.25);
          scene.add(light);
  
          reticle = new THREE.Mesh(
            new THREE.RingBufferGeometry(0.15, 0.2, 32).rotateX(-Math.PI / 2),
            new THREE.MeshBasicMaterial()
          );
          reticle.matrixAutoUpdate = false;
          reticle.visible = false;
          scene.add(reticle);
          // reticle.add(new THREE.AxesHelper(0.5));
          reticle.add(new THREE.Mesh(geometry, new THREE.MeshBasicMaterial()));
  
          controller = renderer.xr.getController(0);
          scene.add(controller);
  
          // scene.add(new THREE.AxesHelper(1));
        }
  
        function render(timestamp, frame) {
          if (frame) {
            var referenceSpace = renderer.xr.getReferenceSpace();
            var session = renderer.xr.getSession();
  
            if (hitTestSourceRequested === false) {
              session
                .requestReferenceSpace("viewer")
                .then(function(referenceSpace) {
                  session
                    .requestHitTestSource({ space: referenceSpace })
                    .then(function(source) {
                      hitTestSource = source;
                    });
                });
              session.addEventListener("end", function() {
                hitTestSourceRequested = false;
                hitTestSource = null;
              });
              hitTestSourceRequested = true;
            }
  
            if (hitTestSource) {
              var hitTestResults = frame.getHitTestResults(hitTestSource);
              if (hitTestResults.length) {
                var hit = hitTestResults[0];
                reticle.visible = true;
                reticle.matrix.fromArray(
                  hit.getPose(referenceSpace).transform.matrix
                );
  
                // TODO apply some additional rotation here
              } else {
                reticle.visible = false;
              }
            }
          }
          renderer.render(scene, camera);
        }
  
        function endXRSession() {
          // Do we have an active session?
          // alert('hello')
          var session = renderer.xr.getSession();
          if (session) {
            // alert('check');
            // End the XR session now.
            session.end().then(onSessionEnd);
          }
        }
  
        // Restore the page to normal after an immersive session has ended.
        function onSessionEnd() {
          gl.bindFramebuffer(gl.FRAMEBUFFER, null);
  
          session = null;
  
          // Ending the session stops executing callbacks passed to the XRSession's
          // requestAnimationFrame(). To continue rendering, use the window's
          // requestAnimationFrame() function.
          window.requestAnimationFrame(onDrawFrame);
        }
      </script>
    </section><!-- End Cta Section -->

    <!-- ======= F.A.Q Section ======= -->
    <section id="faq" class="faq">
      <div class="container">

        <div class="section-title" data-aos="zoom-out">
          <h2>F.A.Q</h2>
          <p>Frequently Asked Questions</p>
        </div>

        <ul class="faq-list">

          <li>
            <div data-bs-toggle="collapse" class="collapsed question" href="#faq1">Is it okay to lean towards laptop for work? <i class="bi bi-chevron-down icon-show"></i><i class="bi bi-chevron-up icon-close"></i></div>
            <div id="faq1" class="collapse" data-bs-parent=".faq-list">
              <p>
                It’s easy to work on your laptop for a few hours on the weekend, but doing so for 40-plus hours a week can lead to back, shoulder, and neck strain. If you can, use an external monitor or laptop stand (with an external keyboard and mouse) to prop up your screen. When looking at the screen, your eye line should be level with the address bar on your web browser.
              </p>
            </div>
          </li>

          <li>
            <div data-bs-toggle="collapse" href="#faq2" class="collapsed question">Can i work on couch? <i class="bi bi-chevron-down icon-show"></i><i class="bi bi-chevron-up icon-close"></i></div>
            <div id="faq2" class="collapse" data-bs-parent=".faq-list">
              <p>
                As tempting as it is, the couch is not an optimal place to work at your computer for the entire day. Although it may be comfortable, having your legs or full body in a vertical position can lead to muscle numbness and discomfort.
              </p>
            </div>
          </li>

          <li>
            <div data-bs-toggle="collapse" href="#faq3" class="collapsed question">Should I sit or stand at work? <i class="bi bi-chevron-down icon-show"></i><i class="bi bi-chevron-up icon-close"></i></div>
            <div id="faq3" class="collapse" data-bs-parent=".faq-list">
              <p>
                Alternative postures and incorporating movement is ideal. Maintaining any one posture for a prolonged period of time, whether seated or standing, can stress the body.  To break up prolonged/monotonous postures, EH&S recommends taking routine microbreaks (~30 – 60 seconds) every 20 minutes to change posture and stretch.
              </p>
            </div>
          </li>

          

        </ul>

      </div>
    </section><!-- End F.A.Q Section -->


  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container">
      <h3>Posture Correction</h3>
      <p>Its a Hackathon Project</p>
      <div class="social-links">
        <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
        <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
        <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
        <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
        <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
      </div>
      <div class="copyright">
        &copy; Copyright <strong><span>Posture Correction</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/selecao-bootstrap-template/ -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
      <audio id="breakMusic" style="display:none" controls>
        <source src="/App/Selecao/assets/music/breakMusic.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
      </audio>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>








<!-- Project Code -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/pose@0.8/dist/teachablemachine-pose.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/pose

    // the link to your model provided by Teachable Machine export panel
    const URL = "./my-pose-model/";
    let model, webcam, ctx, labelContainer, maxPredictions;
    let ctxBadPose1,ctxBadPose2,ctxBadPose3,ctxBadPose4,ctxBadPose5;
    let imageIndex=0;
    let goodPosture=0;
    let breakDuration=1200000;
    let breakTimeout=23000;

    
    var bsecond=document.getElementById("BSecond");
    var btime=new Date();

    
   



    /*
    Chart Configurations
    */

        const data = {
    labels: [
        'Bad Posture',
        'Good Posture',
    ],
    datasets: [{
        label: 'My First Dataset',
        data: [0,0],
        backgroundColor: [
        'rgb(255, 99, 132)',
        'rgb(54, 162, 235)'
        ],
        hoverOffset: 4
    }]
    };
    const config = {
  type: 'doughnut',
  data: data,
};


var myChart = new Chart(
    document.getElementById('myChart'),
    config
  );

  let dateobj=new Date();
                   let label=dateobj.getHours()+":"+dateobj.getMinutes();
                   

  const scatterChartData = {
  datasets: [{
    label: 'Bad Posture',
    data: [{
      x: new Date().getMinutes(),
      y: 5
    }
    ],
    backgroundColor: 'rgb(255, 99, 132)'
  }],
};



  const scatterChartConfig = {
  type: 'scatter',
  data: scatterChartData,
  options: {
    scales: {
      x: {
        type: 'linear',
        position: 'bottom',
        title:{
          display:true,
          text:'Minutes'
        }
      }
    }
  }
};

var badPostureChart = new Chart(
    document.getElementById('badPostureChart'),
    scatterChartConfig
  );
  /*
  chart configuration ends here
  */

    async function init() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        /*Basic Styles*/
        var btn=document.getElementById("startBtn");
        btn.style.display="none"

        var section=document.getElementById("badPoses");
        section.style.display="block"

        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // Note: the pose library adds a tmPose object to your window (window.tmPose)
        model = await tmPose.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();

        // Convenience function to setup a webcam
        const size = 200;
        const flip = true; // whether to flip the webcam
        webcam = new tmPose.Webcam(size, size, flip); // width, height, flip
        await webcam.setup(); // request access to the webcam
        await webcam.play();
        window.requestAnimationFrame(loop);

        // append/get elements to the DOM
        const canvas = document.getElementById("canvas");
        canvas.width = size; canvas.height = size;
        ctx = canvas.getContext("2d");
        labelContainer = document.getElementById("label-container");
        for (let i = 0; i < maxPredictions; i++) { // and class labels
            labelContainer.appendChild(document.createElement("div"));
        }

        //Setting up space for bad poses
        const canvasBadPose1 = document.getElementById("badPose1");
        canvasBadPose1.width = size; canvasBadPose1.height = size;

        const canvasBadPose2 = document.getElementById("badPose2");
        canvasBadPose2.width = size; canvasBadPose2.height = size;

        const canvasBadPose3 = document.getElementById("badPose3");
        canvasBadPose3.width = size; canvasBadPose3.height = size;

        const canvasBadPose4 = document.getElementById("badPose4");
        canvasBadPose4.width = size; canvasBadPose4.height = size;

        const canvasBadPose5 = document.getElementById("badPose5");
        canvasBadPose5.width = size; canvasBadPose5.height = size;

        ctxBadPose1 = canvasBadPose1.getContext("2d");
        ctxBadPose2 = canvasBadPose2.getContext("2d");
        ctxBadPose3 = canvasBadPose3.getContext("2d");
        ctxBadPose4 = canvasBadPose4.getContext("2d");
        ctxBadPose5 = canvasBadPose5.getContext("2d");
    }

    async function loop(timestamp) {
        webcam.update(); // update the webcam frame
        await predict();
        window.requestAnimationFrame(loop);
    }

    async function predict() {
        // Prediction #1: run input through posenet
        // estimatePose can take in an image, video or canvas html element
        const { pose, posenetOutput } = await model.estimatePose(webcam.canvas);
        // Prediction 2: run input through teachable machine classification model
        const prediction = await model.predict(posenetOutput);
        let d=new Date().getMilliseconds();
        let classPrediction="";
        for (let i = 0; i < maxPredictions; i++) {  
            if(prediction[i].className=="Class 1")
            {
               classPrediction ="Good Posture" + ": " + prediction[i].probability.toFixed(2);
                goodPosture=goodPosture+Number(prediction[i].probability.toFixed(2));
                //console.log("adding: "+goodPosture);
            }
                
                else{
                  classPrediction ="Bad Posture" + ": " + prediction[i].probability.toFixed(2);
                  goodPosture=goodPosture-prediction[i].probability.toFixed(2);
                }
                  
                labelContainer.childNodes[i].innerHTML = classPrediction;

           if (d<new Date().getSeconds())
           {
               console.log(goodPosture)
               if (goodPosture<0)
               {
                //    console.log("Bad Posture");
                goodPosture<-20?drawBadPoses(pose,imageIndex):null;
                    drawBadPoses(pose,imageIndex);
                    imageIndex=imageIndex+1;
                    imageIndex=imageIndex%5;
                   document.getElementById("labelGoodPose").innerHTML="Bad Posture";
                   data.datasets[0].data[0]=data.datasets[0].data[0]+1;
                   let dateobj=new Date();
                  //  let label=dateobj.getHours()+":"+dateobj.getMinutes();
                   scatterChartData.datasets[0].data.push({x: dateobj.getMinutes(),y:goodPosture})
                   
               }
               else
               {
                // console.log("Good Posture");
                drawBadPoses(pose,10);
                document.getElementById("labelGoodPose").innerHTML="Good Posture";
                data.datasets[0].data[1]=data.datasets[0].data[1]+1;
                
               }
               d=new Date().getSeconds();
               
               goodPosture=0;
               
               myChart.update();
               badPostureChart.update();
           }

            
            
        }

        // finally draw the poses
        drawPose(pose);
    }

    function drawPose(pose) {
        if (webcam.canvas) {
            ctx.drawImage(webcam.canvas, 0, 0);
            // draw the keypoints and skeleton
            if (pose) {
                const minPartConfidence = 0.5;
                tmPose.drawKeypoints(pose.keypoints, minPartConfidence, ctx);
                tmPose.drawSkeleton(pose.keypoints, minPartConfidence, ctx);
            }
        }
    }

    function drawBadPose(pose) {
        if (webcam.canvas) {
            ctxBadPose1.drawImage(webcam.canvas, 0, 0);
            // draw the keypoints and skeleton
            if (pose) {
                const minPartConfidence = 0.5;
                tmPose.drawKeypoints(pose.keypoints, minPartConfidence, ctxBadPose1);
                tmPose.drawSkeleton(pose.keypoints, minPartConfidence, ctxBadPose1);
            }
        }
    }

    function drawBadPoses(pose,imageIndex) {
        let ctx;
        switch(imageIndex)
        {
            case 0:ctx=ctxBadPose1;break;
            case 1:ctx=ctxBadPose2;break;
            case 2:ctx=ctxBadPose3;break;
            case 3:ctx=ctxBadPose4;break;
            case 4:ctx=ctxBadPose5;break;
        }
        //let ctx=ctxBadPose2;
        if (webcam.canvas && imageIndex<10) {
            ctx.drawImage(webcam.canvas, 0, 0);
            // draw the keypoints and skeleton
            if (pose) {
                const minPartConfidence = 0.5;
                tmPose.drawKeypoints(pose.keypoints, minPartConfidence, ctx);
                tmPose.drawSkeleton(pose.keypoints, minPartConfidence, ctx);
            }
        }
        else
        {
            
        }
    }


    /*
    Performing 20-20-20 Rule
    */

    let breakCount=0;
    const interval=setInterval(breakMethod,breakDuration);
    function breakMethod()
    {
        //alert("Take break");
        
        //var notify=document.getElementById("notify")
        //notify.style.display="block";
        console.log("starting break");
        breakCount=breakCount+1;
        
        //temp
        notifyMe();        

        if (breakCount>3)
        {
            breakCount=0;
            var exercise=document.getElementById("exerciseSection");
            exercise.scrollIntoView();
        }
        else
        {
          var notify=document.getElementById("20Break");
        notify.scrollIntoView();
        document.getElementById("bpane").style.display="block";
        playMusic();
        startBreak();
        }

        
        
        
    }

    function startBreak()
    {
      var second=20;
      var intval=setInterval(() => {
        bsecond.innerHTML=second;
        second=second-1;
        // document.getElementById("pbar").setAttribute('aria-valuenow',second)
        document.getElementById("pbar").style.width=(100-((second/20)*100))+"%"
        // document.getElementById("pbar").style.width="60%"
        if (second<0)
        {
          clearInterval(intval);
        }
      }, 1000);
      
    
        setTimeout(function(){
            // var notify=document.getElementById("notify")
        // notify.style.display="none";
        document.getElementById("bpane").style.display="none";
        stopMusic();
        },breakTimeout)
    }

    function closeExercise()
    {
        var exercise=document.getElementById("exercise");
            exercise.style.display="none";
    }

    function notifyMe() {
  // Let's check if the browser supports notifications
  if (!("Notification" in window)) {
    alert("This browser does not support desktop notification");
  }

  // Let's check whether notification permissions have already been granted
  else if (Notification.permission === "granted") {
    // If it's okay let's create a notification
    var notification = new Notification("Its Time to Take Break!");
  }

  // Otherwise, we need to ask the user for permission
  else if (Notification.permission !== "denied") {
    Notification.requestPermission().then(function (permission) {
      // If the user accepts, let's create a notification
      if (permission === "granted") {
        var notification = new Notification("Its Time to Take Break!");
      }
    });
  }

  // At last, if the user has denied notifications, and you
  // want to be respectful there is no need to bother them any more.
}

function playMusic()
{
  var music=document.getElementById("breakMusic");
  //temp
  music.play();
  console.log("Starting Music");
}

function stopMusic()
{
  var music=document.getElementById("breakMusic");
  //temp
  music.pause();
  console.log("Stop Music");
}


</script>




</body>

</html>